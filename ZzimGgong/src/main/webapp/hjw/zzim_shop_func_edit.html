<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>찜꽁</title>
    <link rel="stylesheet" href="../index_markup/reset.css">
    <link rel="stylesheet" href="./style.css">
    <style type="text/css">

    </style>
    <script type="text/javascript" src="./script/power.js"></script>
</head>

<body>

    <div class="wrapper">
        <header>
            <h1 class="logo"><img src="../index_markup/img/main_logo.png" alt=""></h1>
            <nav class="gnb">
                <ul>
                    <li><a href="#"><img src="../index_markup/img/myPageImg.png" alt=""></a></li>
                </ul>
            </nav>
        </header>
        <section>
            <div class="content">
                <div class="myshop_header">
                    <span class="myshop_name">내 가게</span>
                </div>
                <hr>
                <input type="file" class="real-upload" accept="image/*" required multiple>
                <div class="upload">메뉴 업로드</div>
                <ul class="menu_img"></ul>
                <div class="myshop_img-contain">
                    <img class="myshop_img" src="../index_markup/img/shop_cafeImg.png" alt="">
                </div>
            </div>
        </section>
        <footer>
            <nav class="footer_nav">
                <ul>
                    <li><a href="#">서비스 이용약관</a></li>
                    <li><a href="#">개인정보 처리방침</a></li>
                    <li><a href="#">제휴 문의</a></li>
                    <li><a href="#">채용 공고</a></li>
                </ul>
            </nav>
            <p class="jjim_info">
                (주) 찜꽁<br>
                대표 : 이지원<br>
                주소 : 서울특별시 마포구 월드컵북로 21 2층 풍성빌딩<br>
                사업자등록번호 : 202212142126<br>
                개인정보담당 : service@jjimggong.co.kr
            </p>

        </footer>
    </div>

</body>
<script>
    function getImageFiles(e) {
        const uploadFiles = [];
        const files = e.currentTarget.files;
        const imagePreview = document.querySelector('.menu_img');
        const docFrag = new DocumentFragment();

        if ([...files].length >= 7) {
            alert('이미지는 최대 6개 까지 업로드가 가능합니다.');
            return;
        }

        // 파일 타입 검사
        [...files].forEach(file => {
            if (!file.type.match("image/.*")) {
                alert('이미지 파일만 업로드가 가능합니다.');
                return
            }

            // 파일 갯수 검사
            if ([...files].length < 7) {
                uploadFiles.push(file);
                const reader = new FileReader();
                reader.onload = (e) => {
                    const preview = createElement(e, file);
                    imagePreview.appendChild(preview);
                };
                reader.readAsDataURL(file);
            }
        });
    }

    function createElement(e, file) {
        const li = document.createElement('li');
        const img = document.createElement('img');
        img.setAttribute('src', e.target.result);
        img.setAttribute('data-file', file.name);
        li.appendChild(img);

        return li;
    }

    const realUpload = document.querySelector('.real-upload');
    const upload = document.querySelector('.upload');

    upload.addEventListener('click', () => realUpload.click());

    realUpload.addEventListener('change', getImageFiles);
</script>

</html>